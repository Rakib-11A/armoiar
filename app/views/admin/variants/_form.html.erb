<%= form_for [@product, @variant], url: @variant.new_record? ? admin_product_variants_path(@product, @variant) : admin_product_variant_path(@product, @variant) do |form| %>
  <%= render 'admin/shared/error_messages', target: @variant %>

  <%= form.hidden_field :name, value: @product.name %>

  <div class="row">
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :code %>
        <%= form.text_field :code, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :cost_price %>
        <%= form.text_field :cost_price, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :sale_price %>
        <%= form.text_field :sale_price, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :whole_sale, 'Whole sale price' %>
        <%= form.text_field :whole_sale, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :color_name %>
        <%= form.text_field :color_name, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :color %>
        <%= form.text_field :color, class: 'form-control jscolor' %>
      </div>
    </div>

    <div class="col-md-12" style="padding: 0">
      <div class="col-md-4">
        <div class="checkbox">
          <%= label_tag :discountable, for: :product_discountable do %>
            <%= form.check_box :discountable, id: :product_discountable %>
            Discountable?
          <% end %>
        </div>
      </div>
      <div class="col-md-4">
        <div class="checkbox">
          <%= label_tag :is_amount, for: :product_is_amount do %>
            <%= form.check_box :is_amount, id: :product_is_amount %>
            Is Amount?
          <% end %>
          (Check -> Amount, Uncheck -> Percentage)
        </div>
      </div>
      <div class="col-md-4">
        <div class="form-group field">
          <%= form.label :discount %>
          <%= form.text_field :discount, class: 'form-control' %>
        </div>
      </div>
    </div>

    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :minimum_stock %>
        <%= form.number_field :min_stock, min: 0, class: 'form-control', rows: 13 %>
      </div>
    </div>

    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :size %>
        <%= form.text_field :size, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :weight %>
        <%= form.text_field :weight, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :width %>
        <%= form.text_field :width, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :height %>
        <%= form.text_field :height, class: 'form-control' %>
      </div>
    </div>
    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :depth %>
        <%= form.text_field :depth, class: 'form-control' %>
      </div>
    </div>

    <div class="col-md-4">
      <div class="form-group field">
        <%= form.label :barcode %>
        <% unless @variant.new_record? %>
          <button type="button" class="print-barcode" data-toggle="modal" data-target="#printBarcodeModal">
            <span ></span>Print
          </button>
        <% end %>
        <%= form.text_field :barcode, class: 'form-control' %>
        <span class="color-warning">Make it blank to regenerate.</span>
      </div>
    </div>

    <div class="col-md-12">
      <div class="checkbox">
        <%= label_tag :is_active, for: :product_is_active do %>
          <%= form.check_box :is_active, id: :product_is_active %>
          <%= t(:active) %>
        <% end %>
      </div>
    </div>
  </div>

  <%= render 'admin/shared/form_actions', cancel: admin_product_path(@product), record: form.object %>
<% end %>


<!--Modal-->
<div class="modal fade" id="printBarcodeModal" tabindex="-1" role="dialog" aria-labelledby="printBarcodeModalLabel" aria-hidden="true" >
  <div class="modal-dialog" role="document">
    <div class="modal-content">
      <%= form_for([:admin, PrintBarcode.new]) do |form| %>
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-label="Close">
            <span aria-hidden="true">&times;</span></button>
          <h4 class="modal-title" id="printBarcodeModalLabel"> Barcode Quantity</h4>
        </div>
        <div class="modal-body">
          <div class="form-group">
            <%= form.label :quantity %>
            <%= form.number_field :quantity, class: 'form-control ', id: 'order_shipment_date_modal' %>
          </div>
          <%= form.hidden_field :product_id, :value => @variant.id %>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
          <button type="submit" class="btn btn-primary">Save changes</button>
        </div>
      <% end %>
    </div>
  </div>
</div>
<script type="text/javascript" charset="utf-8">
    $(function () {
        var discountable_element = $('#product_discountable');
        var is_amount_element = $('#product_is_amount');
        var discount_element = $('#product_discount');
        discountable_element.change(function () {
            if (this.checked) {
                is_amount_element.parent().parent().show();
                discount_element.parent().show();

            }
            else {
                is_amount_element.parent().parent().hide();
                discount_element.parent().hide();
                is_amount_element.prop('checked', false);
                discount_element.val(0.0);
            }
        });

        if (!discountable_element.is(':checked')) {
            is_amount_element.parent().parent().hide();
            discount_element.parent().hide();
        }
    });
</script>
