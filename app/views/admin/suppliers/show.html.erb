<% content_for :page_title do %>
  <%= link_to 'Suppliers', admin_suppliers_path %> /
  <%= @supplier.name %>
<% end %>
<%# content_for :page_tabs do %>
<!--  <li role="presentation" class="active"><a data-toggle="tab" href="#">Supplier Info</a></li>-->
<!--  <li role="presentation"><a data-toggle="tab" href="">Invoices</a></li>-->
<!--  <li role="presentation"><a data-toggle="tab" href="#">Discounts</a></li>-->
<!--  <li role="presentation"><a data-toggle="tab" href="#">Refunds</a></li>-->
<%# end %>

<div class="row">
  <div class="col-sm-6">
    <div class="panel panel-default" >
      <div class="panel-heading">
        <h4 class="panel-title title-padding-lg"><b>Details:</b></h4>
      </div>
      <div class="panel-body">
        <table class="table table-borderless" style="margin-bottom: 0;">
          <tbody>
          <tr>
            <td><b>Id: </b></td>
            <td>#<%= @supplier.id %></td>
          </tr>

          <tr>
            <td><b> Name: </b></td>
            <td><%=  @supplier.name %></td>
          </tr>

          <tr>
            <td><b> Email: </b></td>
            <td><%=  @supplier.email %></td>
          </tr>

          <tr>
            <td><b> Mobile: </b></td>
            <td><%=  @supplier.mobile %></td>
          </tr>

          <tr>
            <td><b> Company: </b></td>
            <td> <%= @supplier.company %></td>
          </tr>

          <tr>
            <td><b> Initial Balance: </b></td>
            <td>৳ <%= number_with_delimiter (@supplier.initial_balance), delimiter: ',' %></td>
          </tr>

          <tr>
            <td><b> Current Balance: </b></td>
            <td>৳ <%= number_with_delimiter @supplier.total_invoice, delimiter: ',' %></td>
          </tr>

          <tr>
            <td><b>Initial Balance Date</b></td>
            <td><%= @supplier.initial_balance_date.strftime("%B %d, %Y") %></td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="panel panel-default">
      <div class="panel-body">
        <table class="table table-borderless">
          <tbody>
          <tr>
            <td> <b>Invoices Total</b> <%= link_to admin_suppliers_invoices_path(keywords: @supplier.name) do %>
                <span class="badge" style="background-color: #22A3CC"><%= @supplier.payments.count %></span>
              <% end %>
            </td>
            <td class="right-aligned">৳ <%= number_with_delimiter @supplier.total_invoice, delimiter: ',' %></td>
          </tr>

          <tr>
            <td><b>Invoices Transport Cost</b><%= link_to admin_suppliers_invoices_path(keywords: @supplier.name) do %>
                <span class="badge" style="background-color: #22A3CC"><%= @supplier.invoices.count %></span>
              <% end %>
            </td>
            <td class="right-aligned">৳ <%= number_with_delimiter @supplier.total_transport_cost, delimiter: ',' %></td>
          </tr>

          <tr>
            <td><b>Payments Total</b> <%= link_to  admin_suppliers_payments_path(keywords: @supplier.name)  do %>
                <span class="badge" style="background-color: #22A3CC"><%= @supplier.payments.count %></span>
              <% end %>
            </td>
            <td class="right-aligned">৳ <%= number_with_delimiter @supplier.total_payment, delimiter: ',' %></td>
          </tr>
          <tr>
            <td><b>Refunds Total</b> <%= link_to admin_suppliers_refunds_path(keywords: @supplier.name) do %>
                <span class="badge" style="background-color: #22A3CC"><%= @supplier.refunds.count %></span>
              <% end %>
            </td>
            <td class="right-aligned">৳ <%= number_with_delimiter @supplier.total_refund, delimiter: ',' %></td>
          </tr>

          <tr>
            <td><b>Discounts Total</b> <%= link_to  admin_suppliers_discounts_path(keywords: @supplier.name) do %>
                <span class="badge" style="background-color: #22A3CC"><%= @supplier.discounts.count %></span>
              <% end %>
            </td>
            <td class="right-aligned">৳ <%= number_with_delimiter @supplier.total_discount, delimiter: ',' %></td>
          </tr>

          <tr class="<%= @supplier.due_balance > 0 ? 'danger' : 'success' %>">
            <td><b>Due Balance</b></td>
            <td class="right-aligned">৳ <%= number_with_delimiter @supplier.due_balance, delimiter: ',' %></td>
          </tr>

          <tr>
            <td><b>Pending Payment</b>  <%= link_to  admin_suppliers_payments_path(keywords: @supplier.name, status: 'pending')  do %>
                <span class="badge" style="background-color: #22A3CC"><%= @supplier.pending_payment_count %></span>
              <% end %>
            </td>
            <td class="right-aligned">৳ <%= number_with_delimiter @supplier.pending_payment, delimiter: ',' %></td>
          </tr>
          </tbody>
        </table>
      </div>
    </div>
  </div>
</div>

<div class="row">
  <div class="col-sm-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title title-padding-lg"><b>Invoices: <%= link_to "See All Invoices", admin_suppliers_invoices_path %></b></h4>
      </div>
      <div class="panel-body">
        <% if @invoices.present? %>
        <table class="table table-striped table-condensed">
          <thead>
          <tr>
            <th>Date</th>
            <th>Order Id</th>
            <th>Invoice No.</th>
            <th>Transport Cost</th>
            <th>Amount</th>
          </tr>
          </thead>
          <tbody>
          <% @invoices.each do |invoice| %>
            <tr>
              <td><%= invoice.date.strftime("%B %d, %Y")  %></td>
              <td><%= link_to "##{invoice.id}", admin_suppliers_invoice_path(invoice) %></td>
              <td><%= link_to "#{invoice.no}", invoice.is_order ? admin_suppliers_purchase_order_path(invoice) : admin_suppliers_invoice_path(invoice) %></td>
              <td><%= invoice.transport_cost %></td>
              <td><%= invoice.amount %></td>
            </tr>
          <% end %>
          </tbody>
        </table>
        <% else %>
          <div class="alert alert-info no-objects-found">
            <%= t(:no_resource_found, resource: 'Suppliers Invoice') %>,
            <%= link_to(t(:add_one), new_admin_suppliers_invoice_path) if can? :create, Admin::Suppliers::Invoice %>!
          </div>
        <%end %>
      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title title-padding-lg"><b>Payments: <%= link_to "See All Payments", admin_suppliers_payments_path %></b></h4>
      </div>
      <div class="panel-body">
        <% if @invoices.present? %>
        <table class="table table-striped table-condensed">
          <thead>
          <tr>
            <th>Date</th>
            <th>Payment ID</th>
            <th>Payment Type</th>
            <th>Invoice</th>
            <th>Amount</th>
          </tr>
          </thead>
          <tbody>
          <% @payments.each do |payment| %>
            <tr>
              <td><%= payment.payment_date.strftime("%B %d, %Y") %></td>
              <td><%= link_to "##{payment.id}", admin_suppliers_payment_path(payment)  %></td>
              <td><%= payment.method  %></td>
              <td><%= link_to payment.invoice.no, payment.invoice.is_order ? admin_suppliers_purchase_order_path(payment.invoice) : admin_suppliers_invoice_path(payment.invoice) if payment.invoice.present?  %></td>
              <td><%= payment.amount %></td>
            </tr>
          <% end %>
          </tbody>
        </table>
        <% else %>
          <div class="alert alert-info no-objects-found">
            <%= t(:no_resource_found, resource: 'Suppliers Payment') %>
          </div>
        <%end %>
      </div>
    </div>
  </div>
</div>
<div class="row">
  <div class="col-sm-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title title-padding-lg"><b>Discounts: <%= link_to "See All Discounts", admin_suppliers_discounts_path %></b></h4>
      </div>
      <div class="panel-body">
        <% if @invoices.present? %>
        <table class="table table-striped table-condensed">
          <thead>
          <tr>
            <th>Discount Date</th>
            <th>Discount By</th>
            <th>Invoice</th>
            <th>Amount</th>
            <th>Reason</th>
          </tr>
          </thead>
          <tbody>
          <% @discounts.each do |discount| %>
            <tr>
              <td><%= discount.date.strftime("%B %d, %Y") %></td>
              <td><%= discount.discount_by  %></td>
              <td><%= link_to discount.invoice.no, discount.invoice.is_order ? admin_suppliers_purchase_order_path(discount.invoice) : admin_suppliers_invoice_path(discount.invoice) if discount.invoice.present? %></td>
              <td><%= discount.amount %></td>
              <td><%= discount.discount_reason %></td>
            </tr>
          <% end %>
          </tbody>
        </table>
        <% else %>
          <div class="alert alert-info no-objects-found">
            <%= t(:no_resource_found, resource: 'Suppliers Discount') %>
          </div>
        <%end %>
      </div>
    </div>
  </div>
  <div class="col-sm-6">
    <div class="panel panel-default">
      <div class="panel-heading">
        <h4 class="panel-title title-padding-lg"><b>Refunds: <%= link_to "See All Refunds", admin_suppliers_refunds_path %></b></h4>
      </div>
      <div class="panel-body">
        <% if @invoices.present? %>
        <table class="table table-striped table-condensed">
          <thead>
          <tr>
            <th>Date</th>
            <th>ID</th>
            <th>Refund By</th>
            <th>Invoice</th>
            <th>Amount</th>
            <th>Reason</th>
          </tr>
          </thead>
          <tbody>
          <% @refunds.each do |refund| %>
            <tr>
              <td><%= refund.date.strftime("%B %d, %Y") %></td>
              <td><%= link_to "##{refund.id}", admin_suppliers_refund_path(refund)%></td>
              <td><%= refund.refund_by %></td>
              <td><%= link_to refund.invoice.no, refund.invoice.is_order ? admin_suppliers_purchase_order_path(refund.invoice) : admin_suppliers_invoice_path(refund.invoice) if refund.invoice.present? %></td>
              <td><%= refund.amount %></td>
              <td><%= refund.refund_reason %></td>
            </tr>
          <% end %>
          </tbody>
        </table>
        <% else %>
          <div class="alert alert-info no-objects-found">
            <%= t(:no_resource_found, resource: 'Suppliers Refund') %>
          </div>
        <%end %>
      </div>
    </div>
  </div>
</div>